import numpy as np
import json
import torch
import matplotlib.pyplot as plt
import imageio
from tqdm import tqdm
from skimage.transform import resize
from skimage.util import montage
from matplotlib import cm

# Utility Classes and Functions

class Image3dToGIF3d:
    # [Include the full definition as in the original code]
    pass

class ShowResult:
    # [Include the full definition as in the original code]
    pass

def dice_coef_metric(probabilities, truth, threshold=0.5, eps=1e-9):
    # [Include the full definition as in the original code]
    pass

def jaccard_coef_metric(probabilities, truth, threshold=0.5, eps=1e-9):
    # [Include the full definition as in the original code]
    pass
